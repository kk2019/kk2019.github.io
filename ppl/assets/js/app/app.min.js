/** 
 * -------------------------------------------------------------
 * Copyright (c) 2014 boyaa All rights reserved.
 * http://html5.boyaa.com/
 * -------------------------------------------------------------
 */
! function() {
    var a = parseInt(Date.now() + 1e11 * Math.random()),
        b = {
            img_url: "http://wx.jyc.17188.com/h5/bxppl/icon.png",
            link: "http://wx.jyc.17188.com/h5/bxppl/index.html?timer=" + a,
            desc: "冰雪泡泡龙，小伙伴的最爱。",
            title: "冰雪泡泡龙，快来和我一起玩"
        };
    document.addEventListener("WeixinJSBridgeReady", function() {
        WeixinJSBridge && (window.weixinAPI = {
            shareData: {
                appid: "",
                img_url: "",
                link: "",
                desc: "",
                title: "",
                img_width: "120",
                img_height: "120"
            },
            hideToolbar: function() {
                WeixinJSBridge.call("hideToolbar")
            },
            showOptionMenu: function() {
                WeixinJSBridge.call("showOptionMenu")
            },
            hideOptionMenu: function() {
                WeixinJSBridge.call("hideOptionMenu")
            },
            showToolbar: function() {
                WeixinJSBridge.call("showToolbar")
            },
            init: function() {
                var a = this;
                return WeixinJSBridge.on("menu:share:timeline", function() {
                    WeixinJSBridge.invoke("shareTimeline", {
                        appid: a.shareData.appid,
                        img_url: a.shareData.img_url,
                        link: a.shareData.link,
                        desc: a.shareData.title,
                        title: a.shareData.desc,
                        img_width: "120",
                        img_height: "120"
                    }, function() {
						
                       _czc.push(["_trackEvent", "分享", "朋友圈"])
                    })
                }), WeixinJSBridge.on("menu:share:appmessage", function() {
                    WeixinJSBridge.invoke("sendAppMessage", {
                        appid: a.shareData.appid,
                        img_url: a.shareData.img_url,
                        link: a.shareData.link,
                        desc: a.shareData.title,
                        title: a.shareData.desc,
                        img_width: "120",
                        img_height: "120"
                    }, function() {
                        _czc.push(["_trackEvent", "分享", "好友"])
                    })
                }), this
            }
        }, window.weixinAPI.shareData = b, window.weixinAPI.init())
    }, !1)

	
}();
var str0;
var Util = {
        formateTime: function(a) {
			str0 = a;
            var b = Math.floor(a / 60),
                c = a % 60;
            return b + "′" + c + "″"
        },
        browerKernel: function() {
            var a = null;
            return ["webkit", "moz", "o", "ms"].forEach(function(b) {
                "undefined" != typeof document[b + "Hidden"] && (a = b)
            }), a
        }
    },
    Global = Global || (window.Global = {});
Global.lvList = [{
    star: ["13", "30"],
    map: [
        ["b1", "b1", "b4", "b4", "b3", "b3", "b6", "b6"],
        ["b1", "b1", "b4", "b4", "b3", "b3", "b6"],
        ["b6", "b6", "b3", "b3", "b1", "b1", "b4", "b4"],
        ["b6", "b3", "b3", "b1", "b1", "b4", "b4"],
        [null, null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null, null]
    ]
}, {
    star: ["10", "20"],
    map: [
        [null, "b3", "b3", "b3", "b3", "b3", "b3", null],
        [null, "b4", "b4", "b4", "b4", "b4", null],
        [null, null, "b6", "b6", "b6", "b6", null, null],
        [null, null, null, "b6", null, null, null],
        [null, null, null, "b6", "b6", null, null, null],
        [null, null, null, "b8", null, null, null],
        [null, null, null, "b8", "b8", null, null, null],
        [null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null, null]
    ]
}, {
    star: ["15", "25"],
    map: [
        [null, null, "b3", null, null, "b3", null, null],
        [null, null, "b3", "b4", "b3", null, null],
        [null, null, null, "b4", "b6", null, null, null],
        [null, null, "b4", "b6", "b4", null, null],
        [null, null, null, "b6", "b8", null, null, null],
        [null, null, "b7", "b8", "b7", null, null],
        [null, null, null, "b8", "b7", null, null, null],
        [null, null, null, "b7", null, null, null],
        [null, null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null, null]
    ]
}, {
    star: ["10", "30"],
    map: [
        [null, null, null, "b3", "b3", null, null, null],
        [null, null, "b6", "b3", "b4", null, null],
        [null, null, "b7", "b6", "b4", "b1", null, null],
        [null, "b8", "b7", null, "b1", "b8", null],
        [null, "b1", "b8", null, null, "b8", "b6", null],
        ["b2", "b1", null, null, null, "b6", "b7"],
        [null, "b2", null, null, null, null, "b7", null],
        [null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null, null]
    ]
}, {
    star: ["3", "10"],
    map: [
        [null, null, "b8", "b8", "b8", "b8", null, null],
        [null, "b8", "b4", "b4", "b4", "b8", null],
        [null, "b8", "b4", "b8", "b8", "b4", "b8", null],
        [null, "b8", "b4", "b4", "b4", "b8", null],
        [null, null, "b8", "b8", "b8", "b8", null, null],
        [null, null, "b6", null, "b6", null, null],
        [null, null, "b6", "b6", "b6", "b6", null, null],
        [null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null, null]
    ]
}, {
    star: ["15", "30"],
    map: [
        [null, "b6", "b6", "b6", "b8", "b8", "b8", null],
        ["b6", null, null, null, null, null, "b8"],
        [null, "b6", null, null, null, null, "b8", null],
        ["b6", "b7", "b3", "b4", "b7", "b3", "b8"],
        [null, "b3", "b4", "b7", "b3", "b4", "b7", null],
        [null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null, null]
    ]
}, {
    star: ["15", "30"],
    map: [
        [null, "b8", "b8", null, null, "b7", "b7", null],
        [null, "b1", null, null, null, "b3", null],
        [null, "b8", null, null, null, "b4", null, null],
        [null, "b3", null, null, null, "b8", null],
        [null, "b6", null, null, null, "b1", null, null],
        [null, "b7", null, null, null, "b3", null],
        [null, "b7", null, null, null, "b4", null, null],
        [null, "b3", null, null, null, "b6", null],
        [null, null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null, null]
    ]
}, {
    star: ["15", "35"],
    map: [
        [null, "b2", "b2", null, null, "b1", "b1", null],
        ["b4", null, null, null, null, null, "b6"],
        ["b7", "b4", null, null, null, null, "b6", "b3"],
        ["b7", null, null, null, null, null, "b3"],
        ["b4", "b7", null, null, null, null, "b3", "b6"],
        ["b4", null, null, null, null, null, "b6"],
        ["b2", "b4", null, null, null, null, "b6", "b1"],
        ["b2", "b2", null, null, null, "b1", "b1"],
        [null, null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null, null]
    ]
}, {
    star: ["30", "43"],
    map: [
        ["b3", null, null, null, null, null, null, "b3"],
        ["b8", "b3", "b7", "b6", "b8", "b3", "b7"],
        ["b6", null, null, null, null, null, null, "b6"],
        ["b7", "b6", "b8", "b3", "b7", "b6", "b8"],
        [null, null, null, "b8", null, null, null, null],
        [null, null, null, "b3", null, null, null],
        [null, null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null, null]
    ]
}, {
    star: ["15", "30"],
    map: [
        ["b2", "b2", null, null, null, null, "b1", "b1"],
        ["b4", "b1", null, null, null, "b3", "b6"],
        ["b8", "b4", null, null, null, null, "b6", "b3"],
        ["b8", null, null, null, null, null, "b3"],
        ["b4", "b1", null, null, null, null, "b2", "b6"],
        ["b4", null, null, null, null, null, "b6"],
        ["b2", "b4", null, null, null, null, "b6", "b1"],
        ["b2", "b1", null, null, null, "b2", "b1"],
        [null, null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null, null]
    ]
}, {
    star: ["20", "38"],
    map: [
        [null, "b7", null, "b4", null, "b4", null, "b7"],
        ["b4", "b7", null, "b7", "b4", null, "b4"],
        ["b4", null, "b4", null, "b7", null, "b7", null],
        ["b7", "b4", null, "b4", "b7", null, "b7"],
        [null, "b7", null, "b7", null, "b7", null, "b7"],
        ["b4", "b7", null, "b7", "b4", null, "b4"],
        ["b4", null, "b4", null, "b7", null, "b4", null],
        ["b7", "b7", null, "b4", "b4", null, "b7"],
        [null, "b7", null, "b4", null, "b4", null, "b4"],
        [null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null, null]
    ]
}, {
    star: ["12", "25"],
    map: [
        [null, null, null, "b3", "b3", null, null, null],
        [null, null, "b3", "b3", "b3", null, null],
        [null, null, null, "b1", "b1", null, null, null],
        [null, null, "b4", null, "b4", null, null],
        [null, "b3", null, "b1", "b1", null, "b3", null],
        [null, "b4", "b3", "b1", "b3", "b4", null],
        [null, null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null, null]
    ]
}, {
    star: ["13", "26"],
    map: [
        [null, null, null, null, "b8", null, null, null],
        [null, null, null, "b3", "b8", null, null],
        [null, "b4", "b4", "b3", "b4", "b6", "b3", null],
        ["b3", null, null, "b3", "b6", null, "b4"],
        ["b4", null, null, "b4", null, "b4", "b3", null],
        ["b3", null, "b6", null, null, null, null],
        [null, "b4", "b3", null, null, null, null, null],
        [null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null, null]
    ]
}, {
    star: ["22", "35"],
    map: [
        [null, "b3", "b6", "b6", "b6", "b6", "b3", null],
        [null, null, "b3", null, "b3", null, null],
        [null, null, "b3", "b8", "b8", "b3", null, null],
        [null, null, null, "b6", null, null, null],
        [null, null, null, "b8", "b8", null, null, null],
        [null, null, "b6", "b8", "b6", null, null],
        [null, null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null, null]
    ]
}, {
    star: ["12", "25"],
    map: [
        [null, null, "b8", null, null, null, null, null],
        [null, "b3", "b8", null, null, null, "b1"],
        [null, null, "b1", "b3", null, "b1", "b3", "b8"],
        [null, null, "b6", "b1", "b1", null, "b1"],
        [null, null, null, null, "b1", "b6", "b1", null],
        [null, null, null, "b6", null, null, null],
        [null, null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null, null]
    ]
}, {
    star: ["12", "25"],
    map: [
        [null, null, null, "b8", "b8", null, null, null],
        ["b8", "b3", null, "b8", null, "b3", "b8"],
        [null, "b6", null, "b6", "b6", null, "b6", null],
        [null, "b8", "b8", null, "b8", "b8", null],
        [null, null, null, "b3", "b3", null, null, null],
        [null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null, null]
    ]
}, {
    star: ["12", "25"],
    map: [
        [null, null, null, "b7", "b7", null, null, null],
        [null, "b6", "b6", "b4", "b6", "b6", null],
        ["b4", null, "b6", null, null, "b6", null, "b4"],
        ["b6", "b7", "b6", null, "b6", "b7", "b6"],
        ["b1", "b1", null, null, null, null, "b1", "b1"],
        [null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null, null]
    ]
}, {
    star: ["12", "25"],
    map: [
        [null, null, null, "b7", "b7", null, null, null],
        ["b7", null, null, "b8", null, null, "b7"],
        [null, "b6", "b8", "b8", "b8", "b8", "b6", null],
        ["b8", "b1", null, "b7", null, "b1", "b8"],
        [null, "b1", null, "b6", "b6", null, "b1", null],
        ["b6", null, null, null, null, null, "b6"],
        [null, null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null, null]
    ]
}, {
    star: ["10", "20"],
    map: [
        [null, null, null, "b8", "b8", null, null, null],
        ["b7", "b1", "b8", null, "b8", "b1", "b7"],
        [null, "b4", "b8", null, null, "b8", "b4", null],
        ["b1", null, null, null, null, null, "b1"],
        ["b8", "b7", "b8", "b1", "b1", "b8", "b7", "b8"],
        [null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null, null]
    ]
}, {
    star: ["10", "20"],
    map: [
        [null, null, null, null, null, "b3", "b3", null],
        [null, null, null, null, null, null, "b3"],
        [null, null, null, "b4", "b7", null, "b7", null],
        ["b2", "b8", "b7", null, "b4", "b2", null],
        ["b2", "b3", "b2", "b4", "b7", null, null, null],
        [null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null, null]
    ]
}, {
    star: ["10", "20"],
    map: [
        [null, "b3", "b3", "b7", "b7", "b3", "b3", null],
        ["b6", "b7", "b3", "b3", "b3", "b7", "b6"],
        [null, "b6", null, "b3", "b3", null, "b6", null],
        [null, null, "b3", "b8", "b3", null, null],
        [null, null, null, "b8", "b8", null, null, null],
        [null, null, "b8", "b3", "b8", null, null],
        [null, null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null, null]
    ]
}, {
    star: ["12", "20"],
    map: [
        [null, null, null, "b8", "b8", null, null, null],
        [null, "b1", null, "b8", null, "b1", null],
        [null, null, "b1", "b1", "b1", "b1", null, null],
        [null, "b1", null, "b6", null, "b1", null],
        [null, "b1", "b8", null, null, "b8", "b1", null],
        ["b6", "b8", null, null, null, "b8", "b6"],
        ["b8", "b6", null, null, null, null, "b6", "b8"],
        [null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null, null]
    ]
}, {
    star: ["15", "25"],
    map: [
        [null, "b7", "b7", null, null, "b7", "b7", null],
        ["b8", null, "b3", "b1", "b3", null, "b8"],
        ["b8", null, null, "b3", "b3", null, null, "b8"],
        ["b1", null, null, null, null, null, "b1"],
        [null, "b1", null, null, null, null, "b1", null],
        [null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null, null]
    ]
}, {
    star: ["20", "39"],
    map: [
        [null, null, "b8", null, null, "b8", null, null],
        [null, "b4", null, null, null, "b4", null],
        [null, null, "b3", "b8", "b8", "b3", null, null],
        [null, null, "b4", null, "b4", null, null],
        [null, null, "b4", "b3", "b3", "b4", null, null],
        [null, null, "b6", null, "b6", null, null],
        [null, null, "b3", "b3", "b3", "b3", null, null],
        [null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null, null]
    ]
}, {
    star: ["19", "35"],
    map: [
        [null, null, null, "b1", "b1", null, null, null],
        [null, "b8", "b1", "b4", "b1", "b8", null],
        ["b1", null, "b4", "b8", "b8", "b4", null, "b1"],
        ["b8", "b4", "b8", null, "b8", "b4", "b8"],
        [null, "b4", null, "b8", "b8", null, "b4", null],
        [null, null, "b1", "b4", "b1", null, null],
        [null, null, "b4", "b1", "b1", "b4", null, null],
        [null, null, "b8", "b8", "b8", null, null],
        [null, null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null, null]
    ]
}, {
    star: ["18", "36"],
    map: [
        ["b2", null, null, "b3", "b3", null, null, "b2"],
        ["b2", "b2", "b4", "b3", "b4", "b2", "b2"],
        [null, "b4", null, "b2", "b2", null, "b4", null],
        [null, null, "b4", null, "b4", null, null],
        [null, null, "b2", null, null, "b2", null, null],
        [null, null, "b4", "b4", "b4", null, null],
        [null, null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null, null]
    ]
}, {
    star: ["23", "40"],
    map: [
        ["b4", null, null, null, null, null, null, "b4"],
        ["b4", null, "b7", "b7", "b7", null, "b4"],
        [null, "b4", "b7", "b3", "b3", "b7", "b4", null],
        ["b8", "b7", "b3", null, "b3", "b7", "b8"],
        ["b8", "b7", "b3", null, null, "b3", "b7", "b8"],
        ["b8", "b7", "b3", null, "b3", "b7", "b8"],
        ["b3", "b3", "b3", "b6", "b6", "b3", "b3", "b3"],
        ["b8", "b1", "b8", "b7", "b8", "b1", "b8"],
        [null, null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null, null]
    ]
}, {
    star: ["35", "60"],
    map: [
        [null, "b3", "b3", null, "b3", "b3", "b3", null],
        ["b3", "b7", "b1", "b6", "b8", "b1", "b3"],
        ["b4", "b3", "b3", "b3", null, "b3", "b3", "b4"],
        ["b2", "b4", "b2", "b4", "b2", "b4", "b2"],
        ["b4", "b3", "b3", null, "b3", "b3", "b3", "b4"],
        ["b3", "b1", "b8", "b6", "b1", "b2", "b3"],
        ["b7", "b3", "b3", "b3", null, "b3", "b3", "b7"],
        ["b4", "b4", "b7", "b7", "b7", "b4", "b4"],
        [null, null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null, null]
    ]
}, {
    star: ["15", "30"],
    map: [
        [null, "b8", "b1", null, null, null, null, null],
        ["b3", "b6", "b3", null, null, null, null],
        [null, "b1", "b8", null, null, null, null, null],
        [null, null, "b1", "b3", null, null, null],
        [null, null, "b8", "b6", "b8", null, null, null],
        [null, null, "b3", "b1", null, null, null],
        [null, null, null, null, "b3", "b8", null, null],
        [null, null, null, "b1", "b8", "b1", null],
        [null, null, null, null, "b8", "b3", null, null],
        [null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null, null]
    ]
}, {
    star: ["18", "30"],
    map: [
        [null, null, null, "b7", "b7", null, null, null],
        ["b8", "b6", "b3", "b1", "b3", "b6", "b8"],
        [null, null, null, "b1", "b1", null, null, null],
        [null, null, "b3", null, "b3", null, null],
        [null, null, "b3", null, null, "b3", null, null],
        [null, "b3", "b6", null, "b6", "b3", null],
        [null, null, "b6", null, null, "b6", null, null],
        [null, null, "b3", "b6", "b3", null, null],
        [null, null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null, null]
    ]
}, {
    star: ["10", "25"],
    map: [
        [null, null, null, "b4", "b4", null, null, null],
        ["b4", "b8", "b8", null, "b8", "b8", "b4"],
        ["b8", null, null, null, null, null, null, "b8"],
        ["b8", null, null, null, null, null, "b8"],
        ["b8", "b1", "b1", null, null, "b1", "b1", "b8"],
        [null, null, "b4", null, "b4", null, null],
        [null, null, "b3", "b3", "b3", "b3", null, null],
        [null, "b4", "b8", null, "b8", "b4", null],
        [null, null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null, null]
    ]
}, {
    star: ["15", "35"],
    map: [
        [null, null, null, null, "b6", "b6", null, null],
        ["b2", null, "b8", "b6", null, null, "b8"],
        [null, "b6", null, null, "b6", "b6", "b7", null],
        ["b6", "b2", "b8", null, "b2", null, null],
        [null, null, "b2", null, "b2", null, "b4", "b8"],
        [null, "b4", "b2", null, "b7", "b2", "b8"],
        [null, "b4", "b6", "b8", "b7", null, null, "b2"],
        [null, "b2", "b7", null, null, null, "b8"],
        [null, null, "b6", null, null, null, null, null],
        [null, null, "b8", null, null, null, null],
        [null, null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null, null]
    ]
}, {
    star: ["19", "32"],
    map: [
        [null, null, null, "b7", "b2", "b7", "b2", null],
        [null, null, null, "b7", "b2", "b7", "b3"],
        [null, null, "b4", null, "b7", null, null, null],
        [null, "b3", "b2", "b2", null, "b3", "b4"],
        [null, null, "b4", "b3", null, "b2", null, "b7"],
        [null, "b2", null, "b3", "b7", null, null],
        [null, null, null, null, "b2", "b7", null, null],
        [null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null, null]
    ]
}, {
    star: ["16", "35"],
    map: [
        [null, "b3", null, null, null, null, null, null],
        ["b2", "b2", null, null, null, null, null],
        ["b7", "b3", "b7", null, null, null, null, null],
        [null, null, "b6", null, null, null, null],
        [null, null, null, "b8", null, null, null, null],
        [null, null, null, "b3", null, null, null],
        [null, null, null, "b4", "b8", "b3", "b7", null],
        [null, null, null, "b8", "b3", "b2", "b3"],
        [null, null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null, null]
    ]
}, {
    star: ["15", "32"],
    map: [
        [null, null, null, null, "b6", null, null, null],
        [null, "b8", null, null, "b3", "b2", "b3"],
        [null, "b3", "b2", null, "b2", "b3", "b6", "b3"],
        ["b6", null, "b6", "b6", null, null, null],
        ["b8", null, "b3", "b8", "b2", null, null, null],
        ["b2", null, "b8", null, "b6", "b2", "b2"],
        ["b2", null, "b6", null, null, "b2", null, "b8"],
        [null, "b6", null, null, null, "b2", null],
        [null, null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null, null]
    ]
}, {
    star: ["20", "40"],
    map: [
        [null, null, null, "b6", null, null, null, null],
        [null, "b8", null, "b7", "b6", "b7", null],
        [null, "b6", null, "b7", null, null, "b8", "b4"],
        ["b6", "b7", "b7", null, null, "b8", "b7"],
        ["b4", "b4", "b6", null, null, "b7", "b7", "b8"],
        [null, null, null, "b7", null, "b8", "b6"],
        [null, null, null, null, "b8", "b8", "b6", null],
        [null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null, null]
    ]
}, {
    star: ["20", "40"],
    map: [
        [null, null, "b3", "b1", "b3", "b3", null, null],
        [null, "b3", "b3", null, null, "b3", "b7"],
        [null, null, null, null, "b7", "b4", null, null],
        ["b3", "b1", null, null, null, "b4", "b4"],
        ["b7", null, null, null, "b7", "b7", null, "b7"],
        ["b3", "b1", null, null, "b4", null, null],
        [null, "b3", null, null, "b3", "b4", null, null],
        ["b7", null, "b1", null, null, "b3", "b1"],
        [null, "b4", "b4", "b3", "b1", "b1", null, "b1"],
        [null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null],
        [null, null, null, null, null, null, null, null]
    ]
}];
var Global = Global || (window.Global = {});
Global.imgManifest = [{
    name: "b1",
    src: "bubbles/bubble_1.png"
}, {
    name: "b2",
    src: "bubbles/bubble_2.png"
}, {
    name: "b3",
    src: "bubbles/bubble_3.png"
}, {
    name: "b4",
    src: "bubbles/bubble_4.png"
}, {
    name: "b5",
    src: "bubbles/bubble_5.png"
}, {
    name: "b6",
    src: "bubbles/bubble_6.png"
}, {
    name: "b7",
    src: "bubbles/bubble_7.png"
}, {
    name: "b8",
    src: "bubbles/bubble_8.png"
}, {
    src: "page-room.png"
}, {
    src: "page-lvlist.png"
}, {
    src: "page-idx.png"
}, {
    src: "pic.png"
}, {
    src: "bg-list.png"
}, {
    src: "bg-list-d.png"
}, {
    src: "star.png"
}, {
    src: "star-b.png"
}, {
    src: "next.png"
}, {
    src: "prev.png"
}, {
    name: "compressor",
    src: "compressor.png"
}, {
    name: "btn-pause",
    src: "btn-pause.png"
}, {
    name: "cannon",
    src: "cannon.png"
}, {
    name: "bomb",
    src: "bubbles/bomb.png"
}], Global.imgSource = {};
var Bubble = function(a) {
    return this.data = _.extend({}, a), this.map = this.data.map, this.data.posInfo = this.posInfo, this.hitBubbles = [], this.throwFix = 0, this.init()
};
Bubble.prototype = {
    init: function() {
        var a = Global.imgSource[this.get("type")],
            b = new createjs.Bitmap(a);
        return b.x = this.get("x"), b.y = this.get("y"), b.width = this.get("width"), b.height = this.get("height"), b.name = this.data.id = this.get("type") + "_" + b.id, this.el = b, this
    },
    checkHit: function(a) {
        var b = this.el,
            c = this.get("dx"),
            d = this.get("dy"),
            e = a.params ? a.params[0].delta / 10 : 1,
            f = this,
            g = f.get("parent").compressorOffset;
        b.y += d * e, b.x += c * e, b.y <= g && (b.y = g, this.stop()), b.x >= b.parent.width - b.width ? (c *= -1, b.x = b.parent.width - b.width) : b.x <= 0 && (c *= -1, b.x = 0), this.set("dx", c), _.each(this.get("bubbleList"), function(a) {
            if (a.el.id != f.el.id && !f._stop) {
                var b = Math.sqrt(Math.pow(f.el.x - a.el.x, 2) + Math.pow(f.el.y - a.el.y, 2));
                if (f.get("width") - b > f.throwFix) return void f.stop()
            }
        })
    },
    bomb: function(a) {
        var b = this;
        if (_.each(this.hitBubbles, function(a) {
            if (!_.isString(a)) {
                {
                    var c;
                    _.find(a.hitBubbles, function(a, d) {
                        return _.isString(a) || a.get("id") != b.get("id") ? void 0 : (c = d, !0)
                    })
                }
                a.hitBubbles.splice(c, 1)
            }
        }), this.map[this.posInfo.yIdx][this.posInfo.xIdx] = null, "falldown" == a) {
            var c = this.el.y,
                d = 75 * Math.random() + 30;
            createjs.Tween.get(this.el).to({
                y: c + d,
                opacity: .2
            }, 200).call(function() {
                b.el.parent.removeChild(b.el)
            })
        } else this.bombAnimate()
    },
    bombAnimate: function() {
        var a = new createjs.Sprite(this.get("parent").spriteSheet, "bomb"),
            b = this.el.parent,
            c = this.el;
        b.removeChild(c), a.x = this.el.x - 38, a.y = this.el.y - 38, b.addChild(a), a.on("animationend", function() {
            this.stop(), b.removeChild(a)
        }), a.play("bomb")
    },
    fallDown: function() {
        this.bomb("falldown")
    },
    shoot: function(a, b, c) {
        console.log("发射==>", this.get("id"));
        var d = this,
            e = this.el.parent.x + this.el.x,
            f = this.el.parent.y + this.el.y,
            g = this.get("v"),
            h = this.get("width") / 2 + e - a,
            i = b - f - this.get("width") / 2,
            j = Math.atan(i / h),
            k = g * Math.cos(j) * (0 > j ? -1 : 1),
            l = -1 * g * Math.abs(Math.sin(j));
        this.set("dx", k), this.set("dy", l), this.onStopFn = c, this.el.on("tick", function(a) {
            d._stop || d.checkHit.call(d, a)
        })
    },
    stop: function() {
        console.log("stop---", this.get("id")), this._stop = !0;
        var a = this,
            b = this.el.x,
            c = this.el.y - this.get("parent").compressorOffset,
            d = this.checkPos(b, c, this.get("width"));
        this.map[d.yIdx][d.xIdx] = this, this.checkSiblings(d), a.posInfo = d, _.each(a.hitBubbles, function(a) {
            _.isString(a) || a.shake()
        }), createjs.Tween.get(this.el).to({
            x: d.x,
            y: d.y + a.get("parent").compressorOffset
        }, 50).wait(150).call(function() {
            a.onStopFn && a.onStopFn(a)
        })
    },
    checkSiblings: function(a) {
        a = a || this.posInfo;
        var b, c, d, e, f, g;
        b = this.map[a.yIdx][a.xIdx - 1], b && (-1 == _.indexOf(b.hitBubbles, this) && b.hitBubbles.push(this), -1 == _.indexOf(this.hitBubbles, b) && this.hitBubbles.push(b)), c = this.map[a.yIdx][a.xIdx + 1], c && (-1 == _.indexOf(c.hitBubbles, this) && c.hitBubbles.push(this), -1 == _.indexOf(this.hitBubbles, c) && this.hitBubbles.push(c)), a.yIdx ? (d = a.yIdx % 2 > 0 ? this.map[a.yIdx - 1][a.xIdx] : this.map[a.yIdx - 1][a.xIdx - 1], d && (-1 == _.indexOf(this.hitBubbles, d) && this.hitBubbles.push(d), -1 == _.indexOf(d.hitBubbles, this) && d.hitBubbles.push(this)), e = a.yIdx % 2 > 0 ? this.map[a.yIdx - 1][a.xIdx + 1] : this.map[a.yIdx - 1][a.xIdx], e && (-1 == _.indexOf(this.hitBubbles, e) && this.hitBubbles.push(e), -1 == _.indexOf(e.hitBubbles, this) && e.hitBubbles.push(this))) : this.hitBubbles.push("top"), this.map[a.yIdx + 1] && (f = a.yIdx % 2 > 0 ? this.map[a.yIdx + 1][a.xIdx] : this.map[a.yIdx + 1][a.xIdx - 1], f && (-1 == _.indexOf(this.hitBubbles, f) && this.hitBubbles.push(f), -1 == _.indexOf(f.hitBubbles, this) && f.hitBubbles.push(this)), g = a.yIdx % 2 > 0 ? this.map[a.yIdx + 1][a.xIdx + 1] : this.map[a.yIdx + 1][a.xIdx], g && (-1 == _.indexOf(this.hitBubbles, g) && this.hitBubbles.push(g), -1 == _.indexOf(g.hitBubbles, this) && g.hitBubbles.push(this)))
    },
    checkPos: function(a, b, c) {
        var d = Math.round(b / Math.sqrt(3) / c * 2),
            e = 0;
        d % 2 > 0 && (a -= c / 2, e = c / 2);
        var f = Math.round(a / c);
        return d % 2 && (f = f > 6 ? 6 : f), {
            x: f * c + e,
            y: d * Math.sqrt(3) * c / 2,
            xIdx: f,
            yIdx: d
        }
    },
    shake: function() {
        var a = this.el.y;
        createjs.Tween.get(this.el).to({
            y: a - 10
        }, 70).to({
            y: a
        }, 70)
    },
    get: function(a) {
        return this.data[a]
    },
    set: function(a, b) {
        this.data[a] = b
    }
};
var Game = function(a, b) {
    this.parent = b, this.data = _.extend({
        realWidth: 640,
        realHeight: 960
    }, a), this.el = {
        room: $("#room"),
        infoPage: $("#info"),
        levelList: $("#levelList"),
        resume: $(".resume"),
        restart: $(".restart"),
        back: $(".back"),
        nextLv: $(".nextLv")
    }, this.status = !1, this.bubbleW = 64, this.bubbleH = 64, this.bubbleV = 25, this.bubbleList = [], this.compressorOffset = 0, this.compressorV = 15, this.compressorIdx = 0, this.compressorD = 10, this.gameTime = 0, this.ball_cols = 13, this.bubbleAnim = !1, this.stoneEnable = !1, this.stoneOdds = .1, this.stone_max = 5, this.stone_cur = 0, this._pause = !1, this.bubbleToDisappear = [], this.init()
};
Game.prototype = {
        init: function() {
            this.inited || (this.inited = !0, console.log("关卡==>", this.data.level), $("#room").append('<canvas id="stage" width="640" height="960"></canvas>'), this.el.canvas = $("#stage"), this.stage = new createjs.Stage("stage"), createjs.Touch.enable(this.stage, !0), this.el.canvas.css({
                width: this.data.pageW,
                height: this.data.pageH
            }))
        },
        createEls: function() {
            console.log("create el"), this.bubbleContainer = new createjs.Container, this.bubbleContainer.x = 64, this.bubbleContainer.y = 100, this.bubbleContainer.width = 512, this.bubbleContainer.height = 740, this.stage.addChild(this.bubbleContainer), this.TIMEtxt = new createjs.Text("0", "28px Arial", "#FB8A3B"), this.TIMEtxt.x = 67, this.TIMEtxt.y = 18, this.pauseBtn = new createjs.Bitmap(Global.imgSource["btn-pause"]), this.pauseBtn.x = this.stage.canvas.width - 100, this.pauseBtn.y = 0, this.pauseBtn.cursor = "pointer", this.pauseBtn.width = 72, this.pauseBtn.height = 70;
            var a = new Image;
            a.src = Global.imgSource.bomb, this.spriteSheet = new createjs.SpriteSheet({
                images: [a],
                frames: {
                    width: 140,
                    height: 140
                },
                animations: {
                    bomb: [0, 11]
                }
            }), this.compressor = new createjs.Bitmap(Global.imgSource.compressor), this.compressor.x = 2, this.compressor.y = -40, this.compressor.width = 502, this.compressor.height = 40, this.bubbleContainer.addChild(this.compressor), this.stage.addChild(this.TIMEtxt, this.pauseBtn), this.initEvent()
        },
        initEvent: function() {
            var a = this;
            this.pauseBtn.on("mousedown", function() {
                a.pause.call(a)
            }), this.e_inited || (this.e_inited = !0, this.stage.on("stagemouseup", function(b) {
                a.bubbleAnim || a._pause || (a.bubbleAnim = !0, a.bubbleList.push(a.bubble1), a.bubble1.shoot(b.stageX, b.stageY, function(b) {
                    "stone" != b.get("type") ? a.checkDisappear.call(a, b) : a.checkGameover()
                }), a.drawBubble.call(a, 1))
            }), this.el.resume.on("click", function() {
                a.resume.call(a)
            }), this.el.restart.on("click", function() {
                console.log("resart"), a.reset.call(a), a.start.call(a)
            }), this.el.back.on("click", function() {
                a.back.call(a)
            }), this.el.nextLv.on("click", function() {
                a.nextLv.call(a)
            }))
        },
        start: function() {
            console.log("game start!!!"), this._pause = !1, this.el.levelList.hide(), this.el.room.show(), this.status = !0;
            var a = this;
            this.el.room.show(), this.createEls(), createjs.Ticker.setPaused(!1), createjs.Ticker.hasEventListener("tick") || (createjs.Ticker.setFPS(60), createjs.Ticker.on("tick", function() {
                a._pause || a.stage.update()
            })), this.initMap(), this.drawBubble(2), this.drawBubble(1), this.startTimer()
        },
        drawBubble: function(a) {
            if (2 === a) {
                this.stoneEnable && this.stone_cur < this.stone_max ? (a = Math.random() < this.stoneOdds ? "stone" : _.sample(this.bubbleTypeList), "stone" == a && this.stone_cur++) : a = _.sample(this.bubbleTypeList);
                var b = new Bubble({
                    x: 44,
                    y: this.bubbleContainer.height - 10,
                    width: this.bubbleW,
                    height: this.bubbleH,
                    v: this.bubbleV,
                    parent: this,
                    bubbleList: this.bubbleList,
                    type: a,
                    map: this.map
                });
                this.bubbleContainer.addChild(b.el), this.bubble2 = b
            } else {
                this.bubble2 || this.drawBubble(2);
                var c = this,
                    d = this.bubbleContainer.width / 2 - this.bubbleW / 2,
                    e = this.bubbleContainer.height - this.bubbleH / 2;
                this.bubble1 = this.bubble2, createjs.Tween.get(this.bubble1.el).to({
                    x: d,
                    y: e
                }, 150, createjs.Ease.backOut).call(function() {
                    c.drawBubble(2)
                })
            }
        },
        initMap: function() {
            console.log("===>init map");
            var a = this;
            this.levelData = _.clone(Global.lvList[this.data.level]), this.map = [
                [],
                [],
                [],
                [],
                [],
                [],
                [],
                [],
                [],
                [],
                [],
                [],
                []
            ], this.bubbleTypeList = [], _.each(this.levelData.map, function(b, c) {
                _.each(b, function(b, d) {
                    if (b) {
                        var e = d * a.bubbleW + (c % 2 ? a.bubbleW / 2 : 0),
                            f = c * a.bubbleW * Math.sqrt(3) / 2,
                            g = new Bubble({
                                x: e,
                                y: f,
                                width: a.bubbleW,
                                height: a.bubbleH,
                                v: a.bubbleV,
                                parent: a,
                                bubbleList: a.bubbleList,
                                type: b,
                                map: a.map
                            });
                        g.posInfo = {
                            x: e,
                            y: f,
                            xIdx: d,
                            yIdx: c
                        }, "stone" != b && a.bubbleTypeList.push(b), a.bubbleContainer.addChild(g.el), a.map[c][d] = g, a.bubbleList.push(g)
                    }
                })
            }), _.each(a.bubbleList, function(a) {
                a.checkSiblings()
            }), console.log("绘制地图", this.bubbleContainer, this.stage)
        },
        showFPS: function() {
            var a = createjs.Ticker.getMeasuredFPS().toString().substring(0, 4);
            this.FPStxt.text = "FPS : " + a
        },
        checkDisappear: function(a) {
            this.findBro(a), this.bubbleToDisappear.length > 2 && (this.disappearBubbles(), this.checkFallDown()), this.bubbleToDisappear.length = 0, this.updateBubbleTypeList(), this.checkGameover()
        },
        findBro: function(a) {
            var b = this;
            _.each(a.hitBubbles, function(c) {
                _.isString(c) || -1 != _.indexOf(b.bubbleToDisappear, c.get("id")) || c.get("type") != a.get("type") || (b.bubbleToDisappear.push(c.get("id")), b.findBro.call(b, c))
            })
        },
        disappearBubbles: function() {
            console.log("--> disappear bubbles", this.bubbleToDisappear);
            var a = this;
            _.each(this.bubbleToDisappear, function(b) {
                var c, d = _.find(a.bubbleList, function(a, d) {
                    return a.get("id") == b ? (c = d, !0) : void 0
                });
                d.bomb(), a.removeBubbleFromList.call(a, c)
            })
        },
        removeBubbleFromList: function(a) {
            this.bubbleList.splice(a, 1)
        },
        checkFallDown: function() {
            var a = this,
                b = [],
                c = function(a) {
                    a.set("hasLinks", 1), _.each(a.hitBubbles, function(a) {
                        _.isString(a) || a.get("hasLinks") || c(a)
                    })
                };
            _.each(this.map, function(a) {
                _.each(a, function(a) {
                    a && !a.get("hasLinks") && 0 === a.posInfo.yIdx && (a.set("hasLinks", 1), _.each(a.hitBubbles, function(a) {
                        _.isString(a) || a.get("hasLinks") || c(a)
                    }))
                })
            }), _.each(this.bubbleList, function(a) {
                a.get("hasLinks") ? a.set("hasLinks", !1) : (a.fallDown(), b.push(a))
            }), _.each(b, function(b) {
                var c = _.indexOf(a.bubbleList, b);
                a.removeBubbleFromList.call(a, c)
            }), console.log("--> left", this.bubbleList.length)
        },
        startTimer: function() {
            var a = this,
                b = this.TIMEtxt;
            this.gameTimer = setInterval(function() {
                a.gameTime++, b.text = a.gameTime, a.moveCompressor()
            }, 1e3)
        },
        showInfo: function(a, b) {
            this.el.infoPage.fadeIn(10);
            var c = $("#" + a + "Info");
            if (c.addClass("show"), "gameWin" == a) {
                var d = "";
                c.find(".nextLv")[b.fn](), c.find(".time").html(Util.formateTime(this.gameTime)), _(3).times(function(a) {
                    d += a + 1 <= b.lvInfo.star ? "<i class='star'></i>" : "<i></i>"
                }), c.find(".star-wrap").html(d)
            }
        },
        hideInfo: function() {
            this.el.infoPage.find(".dialog").removeClass("show"), this.el.infoPage.fadeOut(200)
        },
        resume: function() {
            console.log("game resume"), this.hideInfo("resume"), this._pause = !1, this.startTimer(), createjs.Ticker.setPaused(!1)
        },
        reset: function() {
            console.log("game reset"), this.stone_cur = 0, this._pause = !0, this.hideInfo("resume"), clearInterval(this.gameTimer), this.stage.removeAllChildren(), this.bubbleList.length = 0, this.levelData = null, this.bubbleTypeList.length = 0, this.map.length = 0, this.bubbleAnim = !1, this.gameTime = 0, this.compressorOffset = 0, this.compressorIdx = 0
        },
        back: function() {
            console.log("game back"), this.status = !1, this.reset(), this.parent.resetGame()
        },
        nextLv: function() {
            console.warn("next level", this.data.level);
            var a = this.data.level + 1;
            this.data.level = a, this.reset(), this.start()
        },
        pause: function() {
            console.log("game pause"), this._pause = !0, clearInterval(this.gameTimer), this.showInfo("pause")
        },
        stop: function() {
            console.log("game stop"), this._pause = !0, clearInterval(this.gameTimer)
        },
        resize: function(a) {
            this.status && this.pause(), this.el.canvas.width(a.w), this.el.canvas.height(a.h), this.data.pageW = a.w, this.data.pageH = a.h
        },
        updateBubbleTypeList: function() {
            var a = this;
            this.bubbleTypeList.length = 0, _.each(this.bubbleList, function(b) {
                "stone" != b.get("type") && a.bubbleTypeList.push(b.get("type"))
            })
        },
        checkGameover: function() {
            if (console.log("check game over", this.bubbleContainer), this.moveCompressor(!0), 0 === this.bubbleList.length) {
                var a = this;
                return void setTimeout(function() {
                    a.gameWin.call(a)
                }, 500)
            }
            this.bubbleAnim = !1
        },
        moveCompressor: function(a) {
            if (!this.bubbleAnim || a) {
                var b = this,
                    c = Math.floor(this.gameTime / this.compressorD),
                    d = !1;
                c > this.compressorIdx && (this.compressorOffset = this.compressorV * c, this.compressor.y = this.compressorOffset - this.compressor.height, this.compressorIdx = c, _.each(this.bubbleList, function(a) {
                    a.posInfo && (a.el.y = a.posInfo.y + b.compressorOffset)
                })), _.each(this.bubbleList, function(a) {
                    if (a.posInfo) {
                        var c = Math.round(a.el.y / Math.sqrt(3) / b.bubbleH * 2);
                        c >= b.ball_cols - 1 && (d = !0)
                    }
                }), d && b.gameLost()
            }
        },
        gameWin: function() {
            this.stop();
            var a = "show",
                b = localStorage.getItem("lvData");
            b = JSON.parse(b);
            var c = parseInt(localStorage.getItem("lv")),
                d = 3 - _.sortedIndex(this.levelData.star, this.gameTime),
                e = b[this.data.level];
            e = e || {}, (!e.time || e.time > this.gameTime) && (e.time = this.gameTime), (!e.star || e.star < d) && (e.star = d), b[this.data.level] = e, localStorage.setItem("lvData", JSON.stringify(b)), Global.lvList[this.data.level + 1] && c < this.data.level + 1 && localStorage.setItem("lv", this.data.level + 1), Global.lvList[this.data.level + 1] || (console.log("没有下一关了"), a = "hide"), this.showInfo("gameWin", {
                lvInfo: e,
                fn: a
            })
        },
        gameLost: function() {
            this.stop(), this.showInfo("gameLost")
        }
    },
    function() {
        var a = "0.1.6",
            b = function() {
                this.el = {
                    grid: $("#grid"),
                    loading: $("#loading"),
                    levelList: $("#levelList"),
                    index: $("#index"),
                    room: $("#room"),
                    loadingBar: $("#loadingBar"),
                    levelListContainer: $("#levelList ul"),
                    containerWrap: $("#levelList .wrap"),
                    start: $("#start"),
                    goToIndex: $("#goToIndex"),
                    prev: $("#prev"),
                    next: $("#next"),
                    handler_txt: $("#handler .txt"),
                    handler_prev: $("#handler .icon-prev"),
                    handler_next: $("#handler .icon-next")
                }, this.tpl = {
                    lvItem: $("#tpl_lvItem").html()
                }, this.data = {}, this.loading(), this.prefix = Util.browerKernel()
            };
        b.prototype = {
            loading: function() {
                this.el.grid.show(), this.resize();
                var b = localStorage.getItem("_ver");
                b != a && (localStorage.clear(), localStorage.setItem("_ver", a));
                var c = new createjs.LoadQueue(!0, "assets/img/");
                c.on("progress", _.bind(this.handleProgress, this)), c.on("fileload", _.bind(this.handleFileLoad, this)), c.loadManifest(Global.imgManifest)
            },
            handleProgress: function(a) {
                var b = (100 * a.progress).toString().substring(0, 4) + "%";
                if (this.el.loadingBar.width(b), 1 == a.progress) {
                    var c = this;
                    setTimeout(function() {
                        c.init.call(c)
                    }, 500)
                }
            },
            handleFileLoad: function(a) {
                a.item.name && (Global.imgSource[a.item.name] = a.item.src)
            },
            init: function() {
                this.inited || ($("body").attr("class", "index"), $("#win-loading").remove(), this.inited = !0, this.el.loading.hide(), this.el.index.show(), this.updateHandler(), this.updateLevelList(), this.initEvent())
            },
            updateLevelList: function() {
                var a = localStorage.getItem("lvData"),
                    b = parseInt(localStorage.getItem("lv")) || 0,
                    c = this;
                a = a ? JSON.parse(a) : [{
                    time: 0,
                    star: 0
                }];
                var d = "";
                _.each(Global.lvList, function(e, f) {
                    var g = b >= f,
                        h = a[f] || {
                            star: 0,
                            time: 0
                        },
                        i = {
                            className: g ? "unlock" : "lock",
                            lv: f,
                            idx: f + 1,
                            star: g ? h.star : 0,
                            time: g ? Util.formateTime(h.time) : ""
                        },
                        j = _.template(c.tpl.lvItem, i);
                    1 > f % 16 && (j = "<li>" + j), f % 16 == 15 && (j += "</li>"), d += j
                }), this.el.levelListContainer.empty().html(d), this.el.levelListContainer.find("li").width(this.data.pageW), this.el.handler_txt.html(b + 1 + "/" + Global.lvList.length), this.el.containerWrap.data("pageIdx", Math.floor(b / 16)), localStorage.setItem("lv", b), localStorage.setItem("lvData", JSON.stringify(a))
            },
            updateHandler: function() {
                var a = Math.ceil(Global.lvList.length / 16) * this.data.pageW;
                this.el.levelListContainer.width(a), this.el.levelListContainer.find("li").width(this.data.pageW)
            },
            scroll: function() {
                var a = (parseInt(localStorage.getItem("lv")) || 0, this.el.containerWrap.data("pageIdx")),
                    b = this.data.pageW;
                this.el.containerWrap.data("pageIdx", a).animate({
                    scrollLeft: a * b
                }, 200);
                var c = Math.floor(Global.lvList.length / 16);
                this.el.handler_prev.toggle(!!a), this.el.handler_next.toggle(c > a)
            },
            resize: function() {
                var a, b, c = window.innerHeight,
                    d = window.innerWidth,
                    e = 1.5;
                return d * e > c ? (b = c, a = c / e) : (a = d, b = a * e), this.data.pageW = a, this.data.pageH = b, this.el.grid.width(a), this.el.grid.height(b), {
                    w: a,
                    h: b
                }
            },
            initEvent: function() {
                var a = this,
                    b = fingerJS.touch ? "touchend" : "click";
                this.el.start.on(b, function() {
                    a.el.index.hide(), a.el.levelList.show(), a.scroll.call(a)
                }), this.el.levelList.on(b, ".lv-item", function() {
                    var b = $(this).data("lv"),
                        c = $(this).hasClass("lock");
                    c || a.gameStart.call(a, b)
                }), this.el.goToIndex.on(b, function() {
                    a.el.levelList.hide(), a.el.index.show()
                }), $(window).resize(function() {
                    var b = a.resize.call(a);
                    a.game && a.game.resize(b), a.updateHandler.call(a), a.scroll.call(a)
                }), $(window).on("orientationchange", function() {
                    var b = a.resize.call(a);
                    a.game && a.game.resize(b), a.updateHandler.call(a), a.scroll.call(a)
                }), document.addEventListener(a.prefix + "visibilitychange", function() {
                    var b = document[a.prefix + "VisibilityState"];
                    "hidden" == b && a.game && a.game.status && a.game.pause()
                });
                document.querySelector("#levelList ul");
                fingerJS.on("#listWrap", "swipe", function(b) {
                    var c, d = b.type;
                    "swipe-left" == d ? (c = parseInt(a.el.containerWrap.data("pageIdx")) + 1, pageMax = Math.floor(Global.lvList.length / 16), c = c > pageMax ? pageMax : c) : "swipe-right" == d && (c = parseInt(a.el.containerWrap.data("pageIdx")) - 1, c = 0 > c ? 0 : c), a.el.containerWrap.data("pageIdx", c), a.scroll.call(a, c)
                }), $("#weixinShare").on(b, function() {
                    //$("#share").show()
					//alert(str0 + "秒");
					var str = str0 + "秒";
	                try{parent.__4399finishgame(str);}catch(e){}
                }), $("#share").on(b, function() {
                    //$(this).hide()
					//alert("bbb");
                })
            },
            gameStart: function(a) {
                var b = {
                    level: a,
                    pageH: this.data.pageH,
                    pageW: this.data.pageW
                };
                this.game ? this.game.data.level = a : this.game = new Game(b, this), this.game.start()
            },
            resetGame: function() {
                this.updateLevelList(), this.el.room.hide(), this.el.levelList.show(), this.scroll(), $("body").attr("class", "lvList")
            }
        }, window.app = new b
    }();